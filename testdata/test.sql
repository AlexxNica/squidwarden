DELETE FROM groupaccess;
DELETE FROM aclrules;
DELETE FROM rules;
DELETE FROM acls;
DELETE FROM members;
DELETE FROM groups;
DELETE FROM sources;
PRAGMA foreign_keys = ON;
INSERT INTO sources(source_id, source) VALUES('local', '127.0.0.0/8');
INSERT INTO sources(source_id, source) VALUES('bob',   '127.0.0.1/32');
INSERT INTO sources(source_id, source) VALUES('upper', '0.0.0.0/1');
INSERT INTO groups(group_id) VALUES('friends');
INSERT INTO groups(group_id) VALUES('noc');
INSERT INTO members(source_id, group_id) VALUES('local',    'friends');
INSERT INTO members(source_id, group_id) VALUES('bob',      'noc');
INSERT INTO members(source_id, group_id) VALUES('upper',    'friends');
INSERT INTO acls(acl_id) VALUES('sfw');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru1', 'domain',        '.unencrypted.habets.se', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru2', 'regex',         '^http://www.google.co.uk/url?.*$', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru3', 'https-domain',  '.habets.se', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru4', 'https-domain',  '.port.com:8443', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru5', 'https-domain',  'github.com', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru6', 'domain',        '1.2.3.4', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru7', 'domain',        '1.2.3.5:8080', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru8', 'domain',        '9.1.2.0/24', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru9', 'https-domain',  '9.2.2.0/24', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru10', 'domain',       '9.1.2.0/24:8080', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru11', 'https-domain', '9.2.2.0/24:8443', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru12', 'domain',       '9.9.0.1:*', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru13', 'https-domain', '9.9.0.1:*', 'allow');
INSERT INTO rules(rule_id, type, value, action) VALUES('ru14', 'https-domain', '9.10.0.1:*', 'ignore');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru1');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru2');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru3');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru4');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru5');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru6');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru7');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru8');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru9');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru10');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru11');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru12');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru13');
INSERT INTO aclrules(acl_id, rule_id) VALUES('sfw', 'ru14');
INSERT INTO groupaccess(group_id, acl_id) VALUES('friends', 'sfw');

INSERT INTO acls(acl_id) VALUES('noc-acl');
INSERT INTO rules(rule_id, type, value, action) VALUES('nocrule1', 'https-domain', '9.10.0.1:*', 'allow');
INSERT INTO aclrules(acl_id, rule_id) VALUES('noc-acl', 'nocrule1');
INSERT INTO groupaccess(group_id, acl_id) VALUES('noc', 'noc-acl');
